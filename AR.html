<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Demo</title>
    <script src='https://aframe.io/releases/1.3.0/aframe.min.js'></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    
    <style>
        #place-label {
            position: absolute;
            bottom: 50px;
            width: 100%;
            text-align: center;
            font-size: 24px;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 10px;
            border-radius: 8px;
            z-index: 100;
            visibility: hidden;
        }
    </style>
</head>
<body style='margin: 0; overflow: hidden;'>
    <div id="place-label"></div> <!-- Updated place label styling -->
    <a-scene
        cursor='rayOrigin: mouse; fuse: true; fuseTimeout: 0;'
        raycaster="objects: [gps-entity-place];"
        vr-mode-ui="enabled: false"
        embedded
        arjs='sourceType: webcam; sourceWidth:1280; sourceHeight:960; displayWidth: 1280; displayHeight: 960; debugUIEnabled: false;'>
        
        <a-camera gps-camera="minDistance: 40;" rotation-reader></a-camera>
    </a-scene>

    <script>
        window.onload = () => {
            // Load places from static data
            let places = staticLoadPlaces();  // Using pre-defined coordinates
            renderPlaces(places);  // Render icons based on place coordinates
        };

        // Static data loading function
        function staticLoadPlaces() {
            return [
                {
                    name: "หอสมุด",
                    location: {
                        lat: 16.751810773166465,
                        lng: 100.19707168896952
                    },
                    type: "book"
                },
                {
                    name: "สวนหย่อม",
                    location: {
                        lat: 16.75183459215997,
                        lng: 100.19697807710675
                    },
                    type: "park"
                },
                {
                    name: "test1",
                    location: {
                        lat: 16.75179004919567, 
                        lng: 100.19691306466483
                    },
                    type: "parking"
                },
                {
                    name: "test2",
                    location: {
                        lat: 16.75185399757452, 
                        lng: 100.19693597468412
                    },
                    type: "parking"
                },
                {
                    name: "รถ",
                    location: {
                        lat: 16.751822120330228, 
                        lng: 100.19702598359963
                    },
                    type: "parking"
                },
                {
                    name: "ลาน",
                    location: {
                        lat: 16.752136877263755,
                        lng: 100.19691597965682
                    },
                    type: "parking"
                },
                {
                    name: "จอดรถ",
                    location: {
                        lat: 16.751935684680085, 
                        lng: 100.19670524983876
                    },
                    type: "food"
                },
                {
                    name: "หอศิลป์",
                    location: {
                        lat: 16.750686757445894,
                        lng: 100.19439673985032
                    },
                    type: "museum"
                },
                {
                    name: "ธนาคารกรุงไทย",
                    location: {
                        lat:  16.737478107656056,
                        lng: 100.1992812695405
                    },
                    type: "bank"
                },
                {
                    name: "ฟิตเนส",
                    location: {
                        lat: 16.747186578738877,
                        lng: 100.197390492671
                    },
                    type: "gym"
                }
            ];
        }

        // Function to render places with different icons based on type
        function renderPlaces(places) {
            let scene = document.querySelector('a-scene');

            places.forEach((place) => {
                const latitude = place.location.lat;
                const longitude = place.location.lng;

                // Select icon based on place type
                let iconSrc = '';
                switch (place.type) {
                    case 'book':
                        iconSrc = 'image/book.png';
                        break;
                    case 'park':
                        iconSrc = 'image/park.png';
                        break;
                    case 'parking':
                        iconSrc = 'image/parking.png';
                        break;
                    case 'food':
                        iconSrc = 'image/food.png';
                        break;
                    case 'bank':
                        iconSrc = 'image/bank.png';
                        break;
                    case 'gym':
                        iconSrc = 'image/muscle.png';
                        break;
                    case 'museum':
                        iconSrc = 'image/museum.png';
                        break;
                    default:
                        iconSrc = 'image/point.png'; // Default icon
                }

                // Create icon for each place
                const icon = document.createElement('a-image');
                icon.setAttribute('gps-entity-place', `latitude: ${latitude}; longitude: ${longitude}`);
                icon.setAttribute('name', place.name);
                icon.setAttribute('src', iconSrc);
                icon.setAttribute('scale', '15 15 15'); // Reduced size to fit better

                icon.addEventListener('loaded', () => window.dispatchEvent(new CustomEvent('gps-entity-place-loaded')));

                icon.addEventListener('click', (ev) => {
                    ev.stopPropagation();
                    ev.preventDefault();

                    const name = ev.target.getAttribute('name');
                    const label = document.getElementById('place-label');
                    label.innerText = name;
                    label.style.visibility = 'visible';

                    setTimeout(() => {
                        label.style.visibility = 'hidden';
                    }, 2000);
                });

                scene.appendChild(icon);
            });
        }
    </script>
</body>
</html>

